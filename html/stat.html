<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stats · Mini Games</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../css/css.css">
  <style>
    canvas{ width: 100% !important; height: 360px !important; }

    body.dark-mode{ background:#000 !important; color:#facc15 !important; }
    body.dark-mode main{ background:#000 !important; }
    body.dark-mode nav{ background:rgba(0,0,0,0.85) !important; border-color:rgba(250,204,21,0.35) !important; }
    body.dark-mode .bg-white{ background:#0b0b0b !important; }
    body.dark-mode .bg-brand-paper{ background:#000 !important; }
    body.dark-mode .bg-brand-cream{ background:#0f0f0f !important; }
    body.dark-mode .text-brand-ink,
    body.dark-mode .text-brand-muted,
    body.dark-mode .text-brand-ink\/90,
    body.dark-mode .text-brand-muted\/90,
    body.dark-mode .text-brand-ink\/80,
    body.dark-mode .text-brand-muted\/80{ color:#facc15 !important; opacity:1 !important; }
    body.dark-mode .border-brand-line\/70,
    body.dark-mode .border-brand-line\/80{ border-color:rgba(250,204,21,0.35) !important; }
  </style>
</head>
<body>
  <nav class="fixed left-0 top-0 z-50 w-full border-b border-brand-line/70 bg-brand-paper/80 backdrop-blur-xl">
    <div class="relative mx-auto flex w-full max-w-7xl flex-nowrap items-center justify-between gap-4 px-5 py-5 md:px-10">
      <a href="html.html" class="group inline-flex items-center gap-2 font-display text-xl font-bold tracking-tight text-brand-bronze">
        <span class="relative">
          dar lbenna
          <span class="pointer-events-none absolute -bottom-1 left-0 h-px w-0 bg-brand-accent/80 transition-all duration-500 group-hover:w-full"></span>
        </span>
        <span class="text-sm text-brand-accent">★</span>
      </a>

      <div class="hidden flex-1 items-center justify-center md:flex">
        <div class="flex w-full max-w-2xl items-center justify-center gap-6">
          <a href="mini-games.html" class="relative whitespace-nowrap text-sm tracking-wide text-brand-ink/90 transition-colors duration-300 hover:text-brand-primary" data-i18n="stat.back_minigames">Retour mini-games</a>
          <span class="h-px w-10 bg-brand-line/80"></span>
          <span class="relative whitespace-nowrap text-sm font-semibold tracking-wide text-brand-ink/90" data-i18n="stat.nav_title">Stats · Mini Games</span>
        </div>
      </div>

      <div class="flex shrink-0 flex-nowrap items-center gap-3" data-auth-allow>
        <div class="dt-nav-actions flex items-center gap-2" data-auth-allow>
          <button id="langBtn" type="button" class="ui-pill whitespace-nowrap rounded-full text-xs font-semibold uppercase tracking-[0.22em]" data-i18n="nav.language">Language</button>
          <button id="themeToggle" type="button" onclick="window.dtToggleTheme && window.dtToggleTheme()" class="ui-pill whitespace-nowrap rounded-full text-xs font-semibold uppercase tracking-[0.22em]">Dark</button>
        </div>
        <div class="flex flex-wrap items-center gap-3 md:flex" style="justify-content:flex-end;">
          <button type="button" class="ui-pill rounded-full" data-auth-allow>
            <div class="ui-avatar" data-auth-allow>DT</div>
            <div class="ui-identity hidden md:block" data-auth-allow>
              <div id="statUserName" class="ui-name text-sm" data-auth-allow data-i18n="stat.user">Utilisateur</div>
              <div class="ui-sub" data-auth-allow data-i18n="stat.connected">Connecté</div>
            </div>
          </button>
          <button id="statLogoutBtn" type="button" class="ui-pill ui-pill-danger whitespace-nowrap rounded-full text-xs font-semibold uppercase tracking-[0.22em]">
            <span data-i18n="common.logout">Logout</span>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <main class="mt-[110px] bg-brand-paper pb-16">
    <div class="mx-auto w-full max-w-7xl px-5 md:px-10">
      <div class="flex flex-col gap-4 border border-brand-line/70 bg-white p-6 shadow-soft md:flex-row md:items-end md:justify-between">
        <div>
          <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="stat.player_stats">Player stats</div>
          <h1 class="mt-3 font-display text-4xl font-bold tracking-tight text-brand-ink" data-i18n="stat.wins_losses">Wins / Losses</h1>
          <p class="mt-3 max-w-2xl text-sm leading-relaxed text-brand-muted" data-i18n="stat.desc">Statistiques par jeu (vert = wins, rouge = losses). Mise à jour automatique.</p>
        </div>
        <div class="inline-flex items-center gap-3 border border-brand-line/80 bg-brand-cream px-4 py-3 text-xs font-semibold uppercase tracking-[0.22em] text-brand-ink">
          <span class="inline-flex h-2 w-2 rounded-full bg-green-500"></span>
          <span data-i18n="common.live">Live</span>
          <span id="statLastUpdate">—</span>
        </div>
      </div>

      <div class="mt-8 grid gap-6 lg:grid-cols-3">
        <section class="border border-brand-line/70 bg-white p-6 shadow-soft lg:col-span-2">
          <div class="flex flex-col gap-2">
            <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="stat.graph">Graph</div>
            <div class="text-sm text-brand-muted" data-i18n="stat.axes">Jeu (X) · Nombre (Y)</div>
          </div>
          <div class="mt-6">
            <canvas id="statsChart" aria-label="Stats mini games" role="img"></canvas>
          </div>
        </section>

        <aside class="border border-brand-line/70 bg-white p-6 shadow-soft">
          <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="stat.details">Détails</div>
          <div class="mt-4 overflow-hidden border border-brand-line/70">
            <table class="w-full text-left text-sm">
              <thead class="bg-brand-cream">
                <tr>
                  <th class="px-4 py-3 text-xs font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.game">Game</th>
                  <th class="px-4 py-3 text-xs font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.wins">Wins</th>
                  <th class="px-4 py-3 text-xs font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.losses">Losses</th>
                </tr>
              </thead>
              <tbody id="statsTable"></tbody>
            </table>
          </div>

          <div class="mt-5 grid grid-cols-2 gap-3">
            <div class="border border-brand-line/70 bg-white px-4 py-4">
              <div class="text-[11px] font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.total_wins">Total wins</div>
              <div id="kpiWins" class="mt-2 text-xl font-bold text-brand-ink">0</div>
            </div>
            <div class="border border-brand-line/70 bg-white px-4 py-4">
              <div class="text-[11px] font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.total_losses">Total losses</div>
              <div id="kpiLosses" class="mt-2 text-xl font-bold text-brand-ink">0</div>
            </div>
          </div>
        </aside>
      </div>

      <div class="mt-8 grid gap-6 lg:grid-cols-3">
        <section class="border border-brand-line/70 bg-white p-6 shadow-soft lg:col-span-2">
          <div class="flex flex-col gap-2">
            <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="stat.my_products">Mes produits</div>
            <div class="text-sm text-brand-muted" data-i18n="stat.my_products_desc">Note tes produits (1–5). Mise à jour avec animation.</div>
          </div>
          <div class="mt-6">
            <canvas id="ratingsChart" aria-label="Notes produits" role="img"></canvas>
          </div>
        </section>

        <aside class="border border-brand-line/70 bg-white p-6 shadow-soft">
          <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="stat.rate_product">Noter un produit</div>

          <label class="mt-4 block text-xs font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.product">Produit</label>
          <select id="ratingProduct" class="mt-2 w-full border border-brand-line/80 bg-white px-4 py-3 text-sm text-brand-ink outline-none focus:border-brand-accent"></select>

          <div class="mt-5">
            <div class="text-xs font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="stat.rating">Note</div>
            <div class="mt-3 grid grid-cols-5 gap-2">
              <button type="button" class="border border-brand-line/80 bg-white px-3 py-3 text-sm font-semibold text-brand-ink transition-all duration-300 hover:-translate-y-0.5 hover:border-brand-accent" data-rate="1">1</button>
              <button type="button" class="border border-brand-line/80 bg-white px-3 py-3 text-sm font-semibold text-brand-ink transition-all duration-300 hover:-translate-y-0.5 hover:border-brand-accent" data-rate="2">2</button>
              <button type="button" class="border border-brand-line/80 bg-white px-3 py-3 text-sm font-semibold text-brand-ink transition-all duration-300 hover:-translate-y-0.5 hover:border-brand-accent" data-rate="3">3</button>
              <button type="button" class="border border-brand-line/80 bg-white px-3 py-3 text-sm font-semibold text-brand-ink transition-all duration-300 hover:-translate-y-0.5 hover:border-brand-accent" data-rate="4">4</button>
              <button type="button" class="border border-brand-line/80 bg-white px-3 py-3 text-sm font-semibold text-brand-ink transition-all duration-300 hover:-translate-y-0.5 hover:border-brand-accent" data-rate="5">5</button>
            </div>
            <div class="mt-4 border border-brand-line/80 bg-brand-paper px-4 py-3 text-sm">
              <span data-i18n="stat.my_rating">Ma note:</span> <span id="ratingValue" class="font-semibold text-brand-bronze">—</span>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="../javascript/stat.js"></script>
  <script src="../javascript/lang.js"></script>
</body>
</html>

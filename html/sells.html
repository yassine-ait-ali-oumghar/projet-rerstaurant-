<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sales · Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../css/css.css">
  <style>
    canvas{ width: 100% !important; height: 340px !important; }
  </style>
</head>
<body>
  <nav class="fixed left-0 top-0 z-50 w-full border-b border-brand-line/70 bg-brand-paper/80 backdrop-blur-xl">
    <div class="mx-auto flex w-full max-w-7xl flex-nowrap items-center justify-between gap-4 px-5 py-5 md:px-10">
      <a href="html.html" class="group inline-flex items-center gap-2 font-display text-xl font-bold tracking-tight text-brand-bronze">
        <span class="relative">
          dar lbenna
          <span class="pointer-events-none absolute -bottom-1 left-0 h-px w-0 bg-brand-accent/80 transition-all duration-500 group-hover:w-full"></span>
        </span>
        <span class="text-sm text-brand-accent">★</span>
      </a>

      <div class="hidden flex-1 items-center justify-center md:flex">
        <div class="flex w-full max-w-2xl items-center justify-center gap-6">
          <a href="html.html" class="relative whitespace-nowrap text-sm tracking-wide text-brand-ink/90 transition-colors duration-300 hover:text-brand-primary" data-i18n="nav.back_home">Retour accueil</a>
          <span class="h-px w-10 bg-brand-line/80"></span>
          <span class="relative whitespace-nowrap text-sm font-semibold tracking-wide text-brand-ink/90" data-i18n="sells.nav_title">Sales · Admin</span>
        </div>
      </div>

      <div class="flex shrink-0 flex-nowrap items-center gap-3" data-auth-allow>
        <div class="dt-nav-actions flex items-center gap-2" data-auth-allow>
          <button id="langBtn" type="button" class="ui-pill whitespace-nowrap rounded-full text-xs font-semibold uppercase tracking-[0.22em]" data-i18n="nav.language">Language</button>
          <button id="themeToggle" type="button" onclick="window.dtToggleTheme && window.dtToggleTheme()" class="ui-pill whitespace-nowrap rounded-full text-xs font-semibold uppercase tracking-[0.22em]">Dark</button>
        </div>
        <div id="salesUserBadge" class="flex flex-nowrap items-center gap-3 md:flex">
          <button type="button" class="ui-pill rounded-full" data-auth-allow>
            <div class="ui-avatar" data-auth-allow>DT</div>
            <div class="ui-identity hidden md:block" data-auth-allow>
              <div id="salesUserName" class="ui-name text-sm" data-auth-allow>Admin</div>
              <div class="ui-sub" data-auth-allow data-i18n="stat.connected">Connecté</div>
            </div>
          </button>
          <button id="salesLogoutBtn" type="button" class="ui-pill ui-pill-danger whitespace-nowrap rounded-full text-xs font-semibold uppercase tracking-[0.22em]">
            <span data-i18n="common.logout">Logout</span>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <main class="mt-[110px] bg-brand-paper pb-16">
    <div class="mx-auto w-full max-w-7xl px-5 md:px-10">
      <div class="flex flex-col gap-4 border border-brand-line/70 bg-white p-6 shadow-soft md:flex-row md:items-end md:justify-between">
        <div>
          <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="sells.section">Admin dashboard</div>
          <h1 class="mt-3 font-display text-4xl font-bold tracking-tight text-brand-ink" data-i18n="sells.title">Sales</h1>
          <p class="mt-3 max-w-2xl text-sm leading-relaxed text-brand-muted" data-i18n="sells.subtitle">Track revenue by period and category from saved orders.</p>
        </div>

        <div class="flex flex-wrap items-center gap-3">
          <div class="text-xs font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="sells.period.label">Period</div>
          <select id="salesPeriod" class="border border-brand-line/80 bg-white px-4 py-3 text-sm text-brand-ink outline-none focus:border-brand-accent">
            <option value="day" data-i18n="sells.period.day">Daily</option>
            <option value="week" data-i18n="sells.period.week">Weekly</option>
            <option value="month" data-i18n="sells.period.month">Monthly</option>
            <option value="year" data-i18n="sells.period.year">Yearly</option>
          </select>
          <div class="inline-flex items-center gap-3 border border-brand-line/80 bg-brand-cream px-4 py-3 text-xs font-semibold uppercase tracking-[0.22em] text-brand-ink">
            <span class="inline-flex h-2 w-2 rounded-full bg-green-500"></span>
            <span data-i18n="common.live">Live</span>
            <span id="salesLastUpdate">—</span>
          </div>
        </div>
      </div>

      <div class="mt-8 grid gap-6 lg:grid-cols-3">
        <section class="border border-brand-line/70 bg-white p-6 shadow-soft lg:col-span-2">
          <div class="flex flex-col gap-2">
            <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="sells.chart.title">Revenue by category</div>
            <div class="text-sm text-brand-muted" data-i18n="sells.chart.hint">Donut chart is computed from saved orders.</div>
          </div>
          <div class="mt-6">
            <canvas id="salesDonut" aria-label="Sales donut" role="img"></canvas>
          </div>
          <div id="salesEmpty" class="auth-hidden mt-6 border border-brand-line/80 bg-brand-cream px-4 py-3 text-sm text-brand-ink" data-i18n="sells.empty">No orders found for this period.</div>
        </section>

        <aside class="border border-brand-line/70 bg-white p-6 shadow-soft">
          <div class="text-xs font-semibold uppercase tracking-[0.28em] text-brand-muted" data-i18n="sells.kpi.title">KPIs</div>
          <div class="mt-4 grid gap-3">
            <div class="border border-brand-line/70 bg-white px-4 py-4">
              <div class="text-[11px] font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="sells.kpi.revenue">Revenue</div>
              <div id="kpiRevenue" class="mt-2 text-xl font-bold text-brand-ink">0€</div>
            </div>
            <div class="border border-brand-line/70 bg-white px-4 py-4">
              <div class="text-[11px] font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="sells.kpi.orders">Orders</div>
              <div id="kpiOrders" class="mt-2 text-xl font-bold text-brand-ink">0</div>
            </div>
            <div class="border border-brand-line/70 bg-white px-4 py-4">
              <div class="text-[11px] font-semibold uppercase tracking-[0.22em] text-brand-muted" data-i18n="sells.kpi.avg">Avg order</div>
              <div id="kpiAvg" class="mt-2 text-xl font-bold text-brand-ink">0€</div>
            </div>
          </div>

          <div class="mt-6 text-xs leading-relaxed text-brand-muted" data-i18n="sells.source">Source: localStorage keys dt_orders_* (per user).</div>
        </aside>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="../javascript/sells_clean.js"></script>
  <script src="../javascript/lang.js"></script>
</body>
</html>